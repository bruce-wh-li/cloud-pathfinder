<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.33">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" type="image/png" sizes="16x16" href="/vuepress/src/.vuepress/public/ns/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png"><link rel="manifest" href="/manifest.webmanifest"><meta name="application-name" content="VuePress"><meta name="apple-mobile-web-app-title" content="VuePress"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png"><link rel="mask-icon" href="/images/icons/safari-pinned-tab.svg" color="#3eaf7c"><meta name="msapplication-TileColor" content="#3eaf7c"><meta name="theme-color" content="#3eaf7c"><title>Deployment | </title><meta name="description" content="CPF Documentation">
    <link rel="modulepreload" href="/cloud-pathfinder/assets/app.32c85e0d.js"><link rel="modulepreload" href="/cloud-pathfinder/assets/03_deployment.html.28e3fd6f.js"><link rel="modulepreload" href="/cloud-pathfinder/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/cloud-pathfinder/assets/03_deployment.html.263b72cf.js">
    <link rel="stylesheet" href="/cloud-pathfinder/assets/style.e044799a.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/cloud-pathfinder/" class=""><img class="logo" src="/cloud-pathfinder/cloud_pathfinder_icon_2022.png" alt><!----></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/cloud-pathfinder/guide/" class="" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Documentation"><span class="title">Documentation</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Documentation"><span class="title">Documentation</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Pre-Reading Material</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/cloud-pathfinder/Documentation/Pre-reading-material/" class="" aria-label="Pre-Reading Material"><!--[--><!--]--> Pre-Reading Material <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Courses"><span class="title">Courses</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Courses"><span class="title">Courses</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>OpenShift</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/cloud-pathfinder/openshift101/" class="router-link-active" aria-label="OpenShift 101"><!--[--><!--]--> OpenShift 101 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Material"><span class="title">Material</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Material"><span class="title">Material</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>PDF&#39;s</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/bcgov/cloud-pathfinder/raw/master/docs/assets/Pre-reading-material.pdf" rel="noopener noreferrer" target="_blank" aria-label="Pre-reading-material"><!--[--><!--]--> Pre-reading-material <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/bcgov/cloud-pathfinder" rel="noopener noreferrer" target="_blank" aria-label="CloudPathfinder"><!--[--><!--]--> CloudPathfinder <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/cloud-pathfinder/guide/" class="" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Documentation"><span class="title">Documentation</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Documentation"><span class="title">Documentation</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Pre-Reading Material</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/cloud-pathfinder/Documentation/Pre-reading-material/" class="" aria-label="Pre-Reading Material"><!--[--><!--]--> Pre-Reading Material <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Courses"><span class="title">Courses</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Courses"><span class="title">Courses</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>OpenShift</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/cloud-pathfinder/openshift101/" class="router-link-active" aria-label="OpenShift 101"><!--[--><!--]--> OpenShift 101 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Material"><span class="title">Material</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Material"><span class="title">Material</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>PDF&#39;s</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://github.com/bcgov/cloud-pathfinder/raw/master/docs/assets/Pre-reading-material.pdf" rel="noopener noreferrer" target="_blank" aria-label="Pre-reading-material"><!--[--><!--]--> Pre-reading-material <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/bcgov/cloud-pathfinder" rel="noopener noreferrer" target="_blank" aria-label="CloudPathfinder"><!--[--><!--]--> CloudPathfinder <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p class="sidebar-item sidebar-heading active">OpenShift 101 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/cloud-pathfinder/openshift101/00_overview.html" class="sidebar-item" aria-label="Overview"><!--[--><!--]--> Overview <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/01_setup.html" class="sidebar-item" aria-label="Lab Setup"><!--[--><!--]--> Lab Setup <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/01_adding_team_members.html" class="sidebar-item" aria-label="Adding Team Members"><!--[--><!--]--> Adding Team Members <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/01b_web_console_overview.html" class="sidebar-item" aria-label="OCP 4 Web Console"><!--[--><!--]--> OCP 4 Web Console <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/02_builds.html" class="sidebar-item" aria-label="Builds"><!--[--><!--]--> Builds <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Deployment"><!--[--><!--]--> Deployment <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#the-dev-project" class="router-link-active router-link-exact-active sidebar-item" aria-label="The Dev Project"><!--[--><!--]--> The Dev Project <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#create-an-imagestreamtag" class="router-link-active router-link-exact-active sidebar-item" aria-label="Create an ImageStreamTag"><!--[--><!--]--> Create an ImageStreamTag <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#create-an-image-based-deployment" class="router-link-active router-link-exact-active sidebar-item" aria-label="Create an Image-Based Deployment"><!--[--><!--]--> Create an Image-Based Deployment <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#speed-up-application-startup" class="router-link-active router-link-exact-active sidebar-item" aria-label="Speed-up application startup"><!--[--><!--]--> Speed-up application startup <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#objective-1-identify-imagepull-problem" class="router-link-active router-link-exact-active sidebar-item" aria-label="Objective 1: Identify ImagePull Problem"><!--[--><!--]--> Objective 1: Identify ImagePull Problem <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#objective-2-importing-images-to-the-deploy-namespace" class="router-link-active router-link-exact-active sidebar-item" aria-label="Objective 2: Importing Images to the deploy namespace"><!--[--><!--]--> Objective 2: Importing Images to the deploy namespace <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#why-build-in-tools-then" class="router-link-active router-link-exact-active sidebar-item" aria-label="Why Build in Tools Then?"><!--[--><!--]--> Why Build in Tools Then? <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#objective-3-identify-crashloopbackoff-problem" class="router-link-active router-link-exact-active sidebar-item" aria-label="Objective 3: Identify CrashLoopBackOff problem"><!--[--><!--]--> Objective 3: Identify CrashLoopBackOff problem <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#deploying-the-database" class="router-link-active router-link-exact-active sidebar-item" aria-label="Deploying the Database"><!--[--><!--]--> Deploying the Database <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#create-mongo-database-with-ephemeral-storage" class="router-link-active router-link-exact-active sidebar-item" aria-label="Create Mongo Database with Ephemeral Storage"><!--[--><!--]--> Create Mongo Database with Ephemeral Storage <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#from-cli" class="router-link-active router-link-exact-active sidebar-item" aria-label="From CLI"><!--[--><!--]--> From CLI <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#from-the-web-console" class="router-link-active router-link-exact-active sidebar-item" aria-label="From the Web Console"><!--[--><!--]--> From the Web Console <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#verify-mongodb-is-up" class="router-link-active router-link-exact-active sidebar-item" aria-label="Verify MongoDB is up"><!--[--><!--]--> Verify MongoDB is up <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#deployment-configuration-options" class="router-link-active router-link-exact-active sidebar-item" aria-label="Deployment Configuration Options"><!--[--><!--]--> Deployment Configuration Options <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#environment-variables" class="router-link-active router-link-exact-active sidebar-item" aria-label="Environment Variables"><!--[--><!--]--> Environment Variables <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#create-a-route-for-your-rocket-chat-app" class="router-link-active router-link-exact-active sidebar-item" aria-label="Create a Route for your Rocket.Chat App"><!--[--><!--]--> Create a Route for your Rocket.Chat App <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#cli" class="router-link-active router-link-exact-active sidebar-item" aria-label="CLI"><!--[--><!--]--> CLI <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#exploring-health-checks" class="router-link-active router-link-exact-active sidebar-item" aria-label="Exploring Health Checks"><!--[--><!--]--> Exploring Health Checks <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#adding-a-healthcheck" class="router-link-active router-link-exact-active sidebar-item" aria-label="Adding a Healthcheck"><!--[--><!--]--> Adding a Healthcheck <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#using-cli" class="router-link-active router-link-exact-active sidebar-item" aria-label="Using cli"><!--[--><!--]--> Using cli <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/cloud-pathfinder/openshift101/03_deployment.html#summary" class="router-link-active router-link-exact-active sidebar-item" aria-label="Summary"><!--[--><!--]--> Summary <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><li><a href="/cloud-pathfinder/openshift101/04_configuring_deployments.html" class="sidebar-item" aria-label="Exploring Deployment Options"><!--[--><!--]--> Exploring Deployment Options <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/05_resource_management.html" class="sidebar-item" aria-label="Resource Requests and Limits"><!--[--><!--]--> Resource Requests and Limits <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/06_application_availability.html" class="sidebar-item" aria-label="Application Availability"><!--[--><!--]--> Application Availability <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/07_autoscaling.html" class="sidebar-item" aria-label="Autoscaling"><!--[--><!--]--> Autoscaling <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/08_persistent_storage.html" class="sidebar-item" aria-label="Persistent Storage"><!--[--><!--]--> Persistent Storage <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/09_persistent_configurations.html" class="sidebar-item" aria-label="Persistent Configurations"><!--[--><!--]--> Persistent Configurations <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/10_event_streams.html" class="sidebar-item" aria-label="Event Streams"><!--[--><!--]--> Event Streams <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/11_debugging_containers.html" class="sidebar-item" aria-label="Debugging Containers"><!--[--><!--]--> Debugging Containers <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/12_logging_and_visualizations.html" class="sidebar-item" aria-label="Logging and Visualizations"><!--[--><!--]--> Logging and Visualizations <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/13_metrics.html" class="sidebar-item" aria-label="Openshift 4 Metrics"><!--[--><!--]--> Openshift 4 Metrics <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/14_cheatsheet.html" class="sidebar-item" aria-label="Cheatsheet"><!--[--><!--]--> Cheatsheet <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/15_pod_lifecycle.html" class="sidebar-item" aria-label="Pod Lifecycle"><!--[--><!--]--> Pod Lifecycle <!--[--><!--]--></a><!----></li><li><a href="/cloud-pathfinder/openshift101/SUMMARY.html" class="sidebar-item" aria-label="Summary"><!--[--><!--]--> Summary <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="deployment" tabindex="-1"><a class="header-anchor" href="#deployment" aria-hidden="true">#</a> Deployment</h1><p>Since the build and deploy stages are separate, and we have a built image from the previous exercise, we can now deploy this image into the dev project.</p><h2 id="the-dev-project" tabindex="-1"><a class="header-anchor" href="#the-dev-project" aria-hidden="true">#</a> The Dev Project</h2><p>The dev project is where applications are deployed. In this case, we will deploy RocketChat and MongoDB to the dev namespace.</p><h3 id="create-an-imagestreamtag" tabindex="-1"><a class="header-anchor" href="#create-an-imagestreamtag" aria-hidden="true">#</a> Create an ImageStreamTag</h3><blockquote><p>Although we use the tag name <code>dev</code> there are better naming conventions! We strongly suggest associating image tags with a version that is meaninful for your project!</p></blockquote><ul><li>From the CLI</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># retagging the image stream from latest to dev</span>
oc -n <span class="token punctuation">[</span>-tools<span class="token punctuation">]</span> tag rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span>:latest rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span>:dev

<span class="token comment"># Verify that the `dev` tag has been created</span>
oc -n <span class="token punctuation">[</span>-tools<span class="token punctuation">]</span> get imagestreamtag/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span>:dev
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="create-an-image-based-deployment" tabindex="-1"><a class="header-anchor" href="#create-an-image-based-deployment" aria-hidden="true">#</a> Create an Image-Based Deployment</h2><p><strong>Objective</strong>: Deploy RocketChat from the image previously built.</p><ul><li>from the CLI</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> new-app <span class="token punctuation">[</span>-tools<span class="token punctuation">]</span>/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span>:dev --name<span class="token operator">=</span>rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li>The output should be as follows</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>--<span class="token operator">&gt;</span> Found image b949f08 <span class="token punctuation">(</span><span class="token number">2</span> hours old<span class="token punctuation">)</span> <span class="token keyword">in</span> image stream <span class="token string">&quot;[devops-training-namespace]-tools/rocketchat-[username]&quot;</span> under tag <span class="token string">&quot;dev&quot;</span> <span class="token keyword">for</span> <span class="token string">&quot;[devops-training-namespace]-tools/rocketchat-[username]:dev&quot;</span>

    Node.js <span class="token number">8</span> 
    --------- 
    Node.js <span class="token number">8</span> available as container is a base platform <span class="token keyword">for</span> building and running various Node.js <span class="token number">8</span> applications and frameworks. Node.js is a platform built on Chrome<span class="token string">&#39;s JavaScript runtime for easily building fast, scalable network applications. Node.js uses an event-driven, non-blocking I/O model that makes it lightweight and efficient, perfect for data-intensive real-time applications that run across distributed devices.

    Tags: builder, nodejs, nodejs8

    * This image will be deployed in deployment config &quot;rocketchat-[username]&quot;
    * Ports 3000/tcp, 8080/tcp will be load balanced by service &quot;rocketchat-[username]&quot;
      * Other containers can access this service through the hostname &quot;rocketchat-[username]&quot;
    * This image declares volumes and will default to use non-persistent, host-local storage.
      You can add persistent volumes later by running &#39;</span>volume deployment/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> --add <span class="token punctuation">..</span>.<span class="token string">&#39;

--&gt; Creating resources ...
    imagestreamtag &quot;rocketchat-[username]:dev&quot; created
    deployment &quot;rocketchat-[username]&quot; created
    service &quot;rocketchat-[username]&quot; created
--&gt; Success
    Application is not exposed. You can expose services to the outside world by executing one or more of the commands below:
     &#39;</span>oc expose svc/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span><span class="token string">&#39; 
    Run &#39;</span>oc status&#39; to view your app.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="speed-up-application-startup" tabindex="-1"><a class="header-anchor" href="#speed-up-application-startup" aria-hidden="true">#</a> Speed-up application startup</h2><p><strong>Objective</strong>: Get RocketChat to startup faster by tweaking <code>Resource Requests and Limits</code>.</p><blockquote><p>Resource adjustment is also something that will be covered in a later exercise</p></blockquote><p>Increasing the resources (especially CPU) right now will help with faster pod startup.</p><ul><li>From the terminal, run the follow oc command:</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> <span class="token builtin class-name">set</span> resources deployment/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> --requests<span class="token operator">=</span><span class="token string">&#39;cpu=500m,memory=512Mi&#39;</span> --limits<span class="token operator">=</span><span class="token string">&#39;cpu=1000m,memory=1024Mi&#39;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="objective-1-identify-imagepull-problem" tabindex="-1"><a class="header-anchor" href="#objective-1-identify-imagepull-problem" aria-hidden="true">#</a> <strong>Objective 1</strong>: Identify ImagePull Problem</h2><p>As the Web UI indicated, the <code>dev</code> project service accounts do not have the appropriate access to pull the image from the <code>tools</code> project. Admin users manage service accounts and will need to grant rolebindings in order to provide image pull access from two respective namespaces.</p><ul><li>Navigate to <code>Topology</code> and click on the deployment to investigate further</li></ul><p><img src="/cloud-pathfinder/assets/03_deploy_image_04.0adbb3ea.png" alt=""></p><ul><li>Click on the pod within the deployment config and navigate to the pods <code>Events</code> tab for more detail</li></ul><p><img src="/cloud-pathfinder/assets/03_deploy_image_05.009613f5.png" alt=""></p><ul><li>From the CLI add a service account to tools granting image pull access to the from the dev project:</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>oc -n <span class="token punctuation">[</span>-tools<span class="token punctuation">]</span> policy add-role-to-user system:image-puller system:serviceaccount:<span class="token punctuation">[</span>-dev<span class="token punctuation">]</span>:default
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>With the appropriate access in place, you can try bringing up a new pod to see if the issue has been resolved. With Deployments this can be done by <code>oc scale deployment/rocketchat-[username] --replicas=0</code> waiting for the pods to scale down to 0 and then to scale back up with <code>oc scale deployment/rocketchat-[username] --replicas=1</code></p><ul><li>Validate that the image is able to be pulled</li></ul><h2 id="objective-2-importing-images-to-the-deploy-namespace" tabindex="-1"><a class="header-anchor" href="#objective-2-importing-images-to-the-deploy-namespace" aria-hidden="true">#</a> <strong>Objective 2</strong>: Importing Images to the deploy namespace</h2><p>Deploying images from another namespace can run you into some issues that are easily solvable if you import a copy of the image to your deploy namespace. This is a BC Gov best practice in fact.</p><h3 id="why-build-in-tools-then" tabindex="-1"><a class="header-anchor" href="#why-build-in-tools-then" aria-hidden="true">#</a> Why Build in Tools Then?</h3><p>Your Tools namespace has quota that can be best utilized for your CI (Continuous Integration) and devops workloads. Since building an image is apart of the CI pipeline you can run your builds there without impacting the cpu or memory availability for deployment workloads.</p><p>When you ran <code>oc new-app</code> a new imagestream was created in your <code>dev</code> namespace with an image that points to your <code>tools</code> namespace. To import the image from one namespace to another you can:</p><ol><li>Re-tag your tools image tag into this new imagestream</li></ol><p><code>oc -n [-dev] tag [-tools]/rocketchat-[username]:dev rocketchat-[username]:dev</code></p><ol start="2"><li>Modify your Rocket Chat deployment to point to the new image stream. <code>oc -n [-dev] set image deployment/rocketchat-[username] rocketchat-[username]=rocketchat-[username]:dev</code></li></ol><h2 id="objective-3-identify-crashloopbackoff-problem" tabindex="-1"><a class="header-anchor" href="#objective-3-identify-crashloopbackoff-problem" aria-hidden="true">#</a> <strong>Objective 3</strong>: Identify CrashLoopBackOff problem</h2><p>Notice that the deployment is still failing.</p><p><img src="/cloud-pathfinder/assets/03_deploy_image_08a.c80edf77.png" alt=""></p><p>Navigate to the pod and review the logs to determine why the container will not start.</p><p>From the console click the deployment config and click <strong>view logs</strong> beside the failing pod</p><p><img src="/cloud-pathfinder/assets/03_deploy_image_08b.47d111f1.png" alt=""></p><ul><li>Or from the CLI</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># Show your pod&#39;s log</span>
oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> logs -f <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span>oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> get pods --field-selector<span class="token operator">=</span>status.phase<span class="token operator">=</span>Running -l <span class="token assign-left variable">deployment</span><span class="token operator">=</span>rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> -o name --no-headers <span class="token operator">|</span> <span class="token function">head</span> -1<span class="token variable">)</span></span>&quot;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><em>note</em> you can follow the logs with <code>-f</code> argument</p><p>Taking a look at the logs it is clear that the RocketChat pod is failing because it is not able to connect to a <strong>mongo database</strong>.</p><h2 id="deploying-the-database" tabindex="-1"><a class="header-anchor" href="#deploying-the-database" aria-hidden="true">#</a> Deploying the Database</h2><h3 id="create-mongo-database-with-ephemeral-storage" tabindex="-1"><a class="header-anchor" href="#create-mongo-database-with-ephemeral-storage" aria-hidden="true">#</a> Create Mongo Database with Ephemeral Storage</h3><p>Having identified that the application is trying to connect to a mongo database, add a mongo database to the project for your application.</p><h3 id="from-cli" tabindex="-1"><a class="header-anchor" href="#from-cli" aria-hidden="true">#</a> From CLI</h3><ul><li>Find out what &#39;mongodb-ephemeral&#39; is</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> new-app --search mongodb-ephemeral
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li>The output will tell us that <code>mongodb-ephemeral</code> is a template in the <code>openshift</code> project:</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>-----
mongodb-ephemeral
  Project: openshift
  MongoDB database service, without persistent storage. For <span class="token function">more</span> information about using this template, including OpenShift considerations, see https://github.com/sclorg/mongodb-container/blob/master/3.2/README.md.

WARNING: Any data stored will be lost upon pod destruction. Only use this template <span class="token keyword">for</span> testing
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>List available parameters of the template</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>oc -n openshift get template/mongodb-ephemeral -o json <span class="token operator">|</span> oc process -f - --parameters<span class="token operator">=</span>true
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li>Create MongoDB based on a template in the catalog</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>  oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> new-app --template<span class="token operator">=</span>openshift/mongodb-ephemeral -p <span class="token assign-left variable">MONGODB_VERSION</span><span class="token operator">=</span><span class="token number">3.6</span> -p <span class="token assign-left variable">DATABASE_SERVICE_NAME</span><span class="token operator">=</span>mongodb-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> -p <span class="token assign-left variable">MONGODB_USER</span><span class="token operator">=</span>dbuser -p <span class="token assign-left variable">MONGODB_PASSWORD</span><span class="token operator">=</span>dbpass -p <span class="token assign-left variable">MONGODB_DATABASE</span><span class="token operator">=</span>rocketchat --name<span class="token operator">=</span>rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><blockquote><p>If you ran the cli command you would get an output like this</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>Creating resources <span class="token punctuation">..</span>.
    secret <span class="token string">&quot;mongodb-patricksimonian&quot;</span> created
    <span class="token function">service</span> <span class="token string">&quot;mongodb-patricksimonian&quot;</span> created
    deployment.apps.openshift.io <span class="token string">&quot;mongodb-patricksimonian&quot;</span> created
--<span class="token operator">&gt;</span> Success
    Application is not exposed. You can expose services to the outside world by executing one or <span class="token function">more</span> of the commands below:
    <span class="token string">&#39;oc expose svc/mongodb-patricksimonian&#39;</span> 
    Run <span class="token string">&#39;oc status&#39;</span> to view your app.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="from-the-web-console" tabindex="-1"><a class="header-anchor" href="#from-the-web-console" aria-hidden="true">#</a> From the Web Console</h3><ul><li><p>From the side menu click <code>+Add</code>, then select <code>From Catalog</code></p></li><li><p>In the search catalog area, type <code>mongo</code> and select <code>mongodb-ephemeral</code></p></li><li><p>Click Instantiate Template</p></li><li><p>Ensure to customize the details with a service name such as <code>mongodb-[username]</code>, username/password and default database such as <code>rocketchat</code></p></li></ul><p><img src="/cloud-pathfinder/assets/03_deploy_mongo_01.6de02fdc.png" alt=""><img src="/cloud-pathfinder/assets/03_deploy_mongo_02.a51b14fc.png" alt=""><img src="/cloud-pathfinder/assets/03_deploy_mongo_03.c7563a32.png" alt=""></p><h3 id="verify-mongodb-is-up" tabindex="-1"><a class="header-anchor" href="#verify-mongodb-is-up" aria-hidden="true">#</a> Verify MongoDB is up</h3><ul><li>Find the mongodb deployment by going back to <code>Topology</code></li><li>Wait until MongoDB has been successfully deployed MongoDB will generate a lot of logs. Since MongoDB comes with a readiness probe check for pod/container readiness, to know when it is up and ready.</li></ul><p>You can safely ignore repeated messages as such:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>2020-02-06T06:23:41.391+0000 [conn11041]  authenticate db: rocketchat { authenticate: 1, nonce: &quot;xxx&quot;, user: &quot;dbuser&quot;, key: &quot;xxx&quot; }
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="deployment-configuration-options" tabindex="-1"><a class="header-anchor" href="#deployment-configuration-options" aria-hidden="true">#</a> Deployment Configuration Options</h3><p>As a result of using a generic <code>new-app</code> style deployment, as opposed to openshift specific templates, a lot of defaults are leveraged.</p><h3 id="environment-variables" tabindex="-1"><a class="header-anchor" href="#environment-variables" aria-hidden="true">#</a> Environment Variables</h3><p>By default your rocketchat deployment has no environment variables defined. So while RocketChat is trying to start and a database has been deployed, the app does not know how or where to connect to MongoDB. We will need to add environment variables to the deployment configuration.</p><ul><li><p>In the Web Console, navigate to <code>Topology</code> and select your rocketchat deployment</p></li><li><p>Select the <code>Actions</code> tab on the top right <img src="/cloud-pathfinder/assets/03_deploy_env_01.7c77f5c7.png" alt=""></p></li><li><p>Select <code>Edit Deployment</code></p></li><li><p>Select the <code>Environment</code> tab <img src="/cloud-pathfinder/assets/03_deploy_env_02.ec48c0b3.png" alt=""></p></li><li><p>Add the following environment variable with the connection string details configured for mongodb</p></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">MONGO_URL</span><span class="token operator">=</span>mongodb://dbuser:dbpass@mongodb-<span class="token punctuation">[</span>username<span class="token punctuation">]</span>:27017/rocketchat
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><img src="/cloud-pathfinder/assets/03_deploy_config_01.3e4a6cc5.png" alt=""></p><p>You can also use the CLI to apply the environment variable.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> <span class="token builtin class-name">set</span> <span class="token function">env</span> deployment/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> <span class="token string">&quot;MONGO_URL=mongodb://dbuser:dbpass@mongodb-[username]:27017/rocketchat&quot;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li>Click Save</li><li>Navigate to <code>Topology</code> and investigate your RocketChat Deployment Config. It should be redeploying (successfully this time)</li></ul><h4 id="stretch-sensitive-configurations" tabindex="-1"><a class="header-anchor" href="#stretch-sensitive-configurations" aria-hidden="true">#</a> STRETCH: Sensitive Configurations</h4><blockquote><p>this is a stretch exercise, completing this section is not a requirement for the next section of the lab</p></blockquote><p>If you are feeling at odds with things like <strong>dbpass</strong> being out in the open as an environment variable. That is a good thing! For demonstration purposes you are creating a <code>Single Value Env</code>. Sensitive information like passwords should be stored in a <code>Secret</code> and referenced as <code>envFrom</code>. In addition, you can also use the <a href="https://docs.openshift.com/container-platform/4.4/nodes/containers/nodes-containers-downward-api.html#nodes-containers-downward-api-container-secrets_nodes-containers-downward-api" target="_blank" rel="noopener noreferrer">Downward API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> to refer to the secret created by MongoDB.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> rollout pause deployment/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> 

oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> patch deployment/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> -p <span class="token string">&#39;{&quot;spec&quot;:{&quot;template&quot;:{&quot;spec&quot;:{&quot;containers&quot;:[{&quot;name&quot;:&quot;rocketchat-[username]&quot;, &quot;env&quot;:[{&quot;name&quot;:&quot;MONGO_USER&quot;, &quot;valueFrom&quot;:{&quot;secretKeyRef&quot;:{&quot;key&quot;:&quot;database-user&quot;, &quot;name&quot;:&quot;mongodb-[username]&quot;}}}]}]}}}}&#39;</span>

oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> patch deployment/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> -p <span class="token string">&#39;{&quot;spec&quot;:{&quot;template&quot;:{&quot;spec&quot;:{&quot;containers&quot;:[{&quot;name&quot;:&quot;rocketchat-[username]&quot;, &quot;env&quot;:[{&quot;name&quot;:&quot;MONGO_PASS&quot;, &quot;valueFrom&quot;:{&quot;secretKeyRef&quot;:{&quot;key&quot;:&quot;database-password&quot;, &quot;name&quot;:&quot;mongodb-[username]&quot;}}}]}]}}}}&#39;</span>

oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> <span class="token builtin class-name">set</span> <span class="token function">env</span> deployment/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> <span class="token string">&#39;MONGO_URL=mongodb://$(MONGO_USER):$(MONGO_PASS)@mongodb-[username]:27017/rocketchat&#39;</span>

oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> rollout resume deployment/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> 

<span class="token comment"># Check environment variables configuration</span>
oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> get deployment/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> -o json <span class="token operator">|</span> jq <span class="token string">&#39;.spec.template.spec.containers[].env&#39;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="create-a-route-for-your-rocket-chat-app" tabindex="-1"><a class="header-anchor" href="#create-a-route-for-your-rocket-chat-app" aria-hidden="true">#</a> Create a Route for your Rocket.Chat App</h2><p>Your rocketchat application should already have a route created for it. If you were using <code>oc new-app</code> however, a route would not have been created by default.</p><h3 id="cli" tabindex="-1"><a class="header-anchor" href="#cli" aria-hidden="true">#</a> CLI</h3><p>There are 2 ways of creating routes using CLI.</p><ul><li>Using <code>oc expose</code> for unsecure (http) route</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> expose svc/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li>Using <code>oc create route</code> for secure (https) route</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> create route edge rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> --service<span class="token operator">=</span>rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> --insecure-policy<span class="token operator">=</span>Redirect
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>After creating the route you may access your application! <img src="/cloud-pathfinder/assets/03_deploy_route.22d76860.png" alt="rocketchat"></p><h2 id="exploring-health-checks" tabindex="-1"><a class="header-anchor" href="#exploring-health-checks" aria-hidden="true">#</a> Exploring Health Checks</h2><ul><li>If you redeploy the rocket chat application there is an interval where the pod is considered ready but it is still not available to be accessed.</li><li>You can check this by killing the pod, waiting for the pod to redeploy and be <code>ready</code> and then visit your Rocket Chat url.</li></ul><p><img src="/cloud-pathfinder/assets/03_deploy_pod_delete_01.891795f0.png" alt=""><img src="/cloud-pathfinder/assets/03_deploy_pod_delete_02.09aa3545.png" alt=""></p><h3 id="adding-a-healthcheck" tabindex="-1"><a class="header-anchor" href="#adding-a-healthcheck" aria-hidden="true">#</a> Adding a Healthcheck</h3><p>A container that is marked <code>ready</code> when it is not is an indication of a lack of (or misconfigured) healthcheck.</p><p>You can add a healthcheck for <code>readiness</code> and <code>liveness</code>.</p><h3 id="using-cli" tabindex="-1"><a class="header-anchor" href="#using-cli" aria-hidden="true">#</a> Using cli</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>oc -n <span class="token punctuation">[</span>-dev<span class="token punctuation">]</span> <span class="token builtin class-name">set</span> probe deployment/rocketchat-<span class="token punctuation">[</span>username<span class="token punctuation">]</span> --readiness --get-url<span class="token operator">=</span>http://:3000/ --initial-delay-seconds<span class="token operator">=</span><span class="token number">15</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="summary" tabindex="-1"><a class="header-anchor" href="#summary" aria-hidden="true">#</a> Summary</h3><p>You added a <strong>readiness</strong> check to the <code>rocketchat-[username]</code> deployment so that you no longer have a false positive of when the pod should be considered available. By default pods are considered to be &#39;ready&#39; when the container starts up and the entrypoint script is running. This however is not useful for things like webservers or databases! Not only do you need the entrypoint script to run but you need to wait for the server to listen on a port.</p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/bcgov/cloud-pathfinder/edit/master/vuepress/src/openshift101/03_deployment.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub"><!--[--><!--]--> Edit this page on GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 66041048+jon-mc-git@users.noreply.github.com">Jon McCaig</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/cloud-pathfinder/openshift101/02_builds.html" class="" aria-label="Builds"><!--[--><!--]--> Builds <!--[--><!--]--></a></span><span class="next"><a href="/cloud-pathfinder/openshift101/04_configuring_deployments.html" class="" aria-label="Exploring Deployment Options"><!--[--><!--]--> Exploring Deployment Options <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/cloud-pathfinder/assets/app.32c85e0d.js" defer></script>
  </body>
</html>
